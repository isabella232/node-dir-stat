(this["webpackJsonpnode-dir-stat"]=this["webpackJsonpnode-dir-stat"]||[]).push([[0],{17:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var r=n(2),i=n(1),c=n.n(i),a=n(10),s=n.n(a),o=(n(17),n(3)),u=n.n(o),l=n(6),f=n(7),h=n(11),d=n(12),j=function(){function e(t){var n=t.capacity,r=t.retries;Object(h.a)(this,e),this.size=0,this.capacity=n||5,this.retries=r||5,this.jobs=[],this.doneListeners=[],this.progressListeners=[]}return Object(d.a)(e,[{key:"_fetchWithRetry",value:function(){var e=Object(f.a)(u.a.mark((function e(t,n){var r,i,c,a=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=u.a.mark((function e(r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,n);case 3:return e.t0=e.sent,e.abrupt("return",{v:e.t0});case 7:if(e.prev=7,e.t1=e.catch(0),r!==a.retries-1){e.next=11;break}throw e.t1;case 11:return e.next=13,new Promise((function(e){return setTimeout(e,1e3*(r+1)*(r+1))}));case 13:case"end":return e.stop()}}),e,null,[[0,7]])})),i=0;case 2:if(!(i<this.retries)){e.next=10;break}return e.delegateYield(r(i),"t0",4);case 4:if("object"!==typeof(c=e.t0)){e.next=7;break}return e.abrupt("return",c.v);case 7:i++,e.next=2;break;case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_onJobDone",value:function(){if(this.size-=1,0===this.size){var e,t=Object(l.a)(this.doneListeners);try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(i){t.e(i)}finally{t.f()}this.doneListeners=[]}else this._tryDequeue();var n,r=Object(l.a)(this.progressListeners);try{for(r.s();!(n=r.n()).done;){(0,n.value)()}}catch(i){r.e(i)}finally{r.f()}}},{key:"_tryDequeue",value:function(){var e=this;if(!(this.size>=this.capacity)&&0!==this.jobs.length){var t=this.jobs.pop(),n=t.url,r=t.options,i=t.resolve,c=t.reject;this.size+=1,this._fetchWithRetry(n,r).catch((function(t){c(t),e._onJobDone()})).then((function(t){i(t),e._onJobDone()}))}}},{key:"fetch",value:function(e,t){var n=this;return new Promise((function(r,i){n.jobs.push({url:e,options:t,resolve:r,reject:i}),n._tryDequeue()}))}},{key:"on",value:function(e,t){"progress"===e&&this.progressListeners.push(t)}},{key:"wait",value:function(){var e=this;return new Promise((function(t){e.doneListeners.push(t)}))}}]),e}();function p(e,t){Object.keys(e).forEach((function(n){t(n,e[n]),p(e[n].dependencies||{},t)}))}function v(e,t,n){e&&e.children&&((n=n||{})[e.name]||(n[e.name]=!0,t(e),e.children.forEach((function(e){v(e,t,n)}))))}var b=function e(t){return t?t.map((function(t){var n=t.size,r=t.files;return(n||0)+e(r)})).reduce((function(e,t){return e+t}),0):0};function m(e,t){var n=new j({capacity:10,retries:2}),r=0;return new Promise((function(i){for(var c=function(){var c=s[a];n.fetch("https://unpkg.com/"+c.name+"@"+c.version+"/?meta").then((function(e){return e.json()})).catch((function(e){console.error("Error for "+c.name+": "+e)})).then((function(n){c.size=n?b(n.files):1e6,t(100*(r+=1)/Object.values(e).length),r===Object.values(e).length&&i(null)}))},a=0,s=Object.values(e);a<s.length;a++)c()}))}function x(){return(x=Object(f.a)(u.a.mark((function e(t,n){var r,i,c,a,s,o,f,h,d,j,b,x;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Map,i={},p(t,(function(e,t){r.set(e,new Set),i[e]={name:e,version:t.version,children:new Set}})),p(t,(function(e,t){for(var n=0,c=Object.keys(t.requires||{});n<c.length;n++){var a=c[n];r.get(a).add(e),i[e].children.add(i[a])}for(var s=0,o=Object.keys(t.dependencies||{});s<o.length;s++){var u=o[s];r.get(u).add(e),i[e].children.add(i[u])}})),e.next=6,m(i,n);case 6:for(c=function(e){var t=new Set;return function e(n){var i,c=Object(l.a)(n);try{for(c.s();!(i=c.n()).done;){var a=i.value;t.has(a)||(t.add(a),e(r.get(a)))}}catch(s){c.e(s)}finally{c.f()}}(r.get(e)),t.size},(a=Object.values(i)).sort((function(e,t){return c(e.name)-c(t.name)})),s=function(){var e=f[o];e.totalSize=0,v(e,(function(t){return e.totalSize+=t.size}))},o=0,f=a;o<f.length;o++)s();for(h={},d=[],j=0,b=a;j<b.length;j++)x=b[j],h[x.name]||d.push(x),v(x,(function(e){return h[e.name]=!0}));return e.abrupt("return",d);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=n(8),g=n(0);function O(e){var t,n,r=e.node,i=e.i,c=e.height,a=e.setCurrNode;return Object(g.jsx)("div",{className:"graphbox",style:{display:"flex",flexWrap:"wrap",justifyContent:"center",alignItems:"center",height:95*c+"vh",minWidth:"8rem",textAlign:"center",background:(n=i,"hsl(".concat(137.508*n,",50%,75%)")),cursor:r.children.size>0?"pointer":"inherit"},onClick:function(){0!==r.children.size&&a(r)},children:Object(g.jsxs)("div",{children:[Object(g.jsx)("h5",{style:{margin:0},children:r.name}),Object(g.jsxs)("h5",{style:{marginTop:".25rem"},children:["(",(t=r.totalSize,(t<1e3?t+"B":t<1e6?(t/1e3).toFixed(1)+"kB":t<1e9?(t/1e6).toFixed(1)+"MB":(t/1e9).toFixed(2)+"GB")+", "+(r.children.size>0?r.children.size:"no"))," children)"]})]})})}function k(e){var t=e.graph,n=e.setCurrNode,r=Object(y.a)(t),i=Math.ceil(Math.sqrt(r.length));if(0===i)return Object(g.jsx)("div",{children:"No nodes."});var c=new Array(i).fill(null).map((function(e,t){return r.slice(i*t,i*(t+1))}));return Object(g.jsx)("div",{style:{overflowX:"auto",display:"flex",flexDirection:"row",justifyContent:"center"},children:c.map((function(e,t){return Object(g.jsx)("div",{style:{display:"flex",flexDirection:"column",alignContent:"flex-start",minHeight:"50vh",maxHeight:"calc(95vh + 2px)",width:100*e.map((function(e){return e.totalSize})).reduce((function(e,t){return e+t}),0)/r.map((function(e){return e.totalSize})).reduce((function(e,t){return e+t}),0)+"%",maxWidth:"50%"},children:e.map((function(t,r){return Object(g.jsx)(O,{node:t,i:r,setCurrNode:n,height:t.totalSize/e.map((function(e){return e.totalSize})).reduce((function(e,t){return e+t}),0)},t.name)}))},t)}))})}function w(e){var t=e.elements,n=e.onClick;return Object(g.jsx)("div",{style:{display:"flex",flexDirection:"row",margin:"1rem"},children:Object(y.a)(t).map((function(e,t){return Object(g.jsxs)("span",{children:[0!==t?Object(g.jsx)("i",{className:"feather icon-chevron-right",style:{margin:"0 0.5rem"}}):null,Object(g.jsx)("a",{href:"#",onClick:function(t){t.preventDefault(),n(e)},children:e.name})]},e.name)}))})}function z(e){var t=e.graph,n=c.a.useState(t),i=Object(r.a)(n,2),a=i[0],s=i[1];c.a.useEffect((function(){a||s(t)}),[t]);var o=c.a.useState([{name:"(root)",children:t}]),u=Object(r.a)(o,2),l=u[0],f=u[1];return Object(g.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(g.jsx)(w,{elements:l,onClick:function(e){var t=l.findIndex((function(t){return t.name===e.name}));t>=0&&f(l.slice(0,t+1)),s(e.children)}}),Object(g.jsx)(k,{graph:a,setCurrNode:function(e){s(Object(y.a)(e.children)),l.push(e)}})]})}var S=function(){var e=c.a.useState(null),t=Object(r.a)(e,2),n=t[0],i=t[1],a=c.a.useState(null),s=Object(r.a)(a,2),o=s[0],u=s[1],l=c.a.useState(null),f=Object(r.a)(l,2),h=f[0],d=f[1],j=c.a.useState(null),p=Object(r.a)(j,2),v=p[0],b=p[1],m=c.a.useState("Initializing..."),y=Object(r.a)(m,2),O=y[0],k=y[1];return c.a.useEffect((function(){o&&1!==o.lockfileVersion?d("Invalid lockfile - we expect 'lockfileVersion=1' from package-lock-old.json"):o&&function(e,t){return x.apply(this,arguments)}(o.dependencies,(function(e){k("Setting sizes ("+e.toFixed(1)+"%)")})).catch((function(e){return d(""+e)})).then((function(e){e&&b(e)}))}),[o]),Object(g.jsxs)("main",{style:{display:"flex",flexDirection:"column"},children:[o?null:Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(g.jsxs)("button",{className:"upload-file-button",onClick:function(){return n.click()},children:[Object(g.jsx)("i",{className:"feather icon-play-circle",style:{fontSize:"0.85rem",display:"inline-block"}})," Upload a package-lock.json file"]})}),Object(g.jsx)("input",{type:"file",accept:".json",style:{visibility:"hidden"},ref:i,onChange:function(e){if(e.target&&e.target.files&&e.target.files[0]){var t=new FileReader;t.onload=function(e){try{u(JSON.parse(e.target.result))}catch(e){d("Could not load package lock json: "+e)}},t.readAsBinaryString(e.target.files[0])}}})]}),o&&!v?Object(g.jsxs)("div",{style:{minHeight:"10rem",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[Object(g.jsx)("h5",{children:"Pulling package size data from unpkg.com..."}),Object(g.jsx)("div",{children:O})]}):null,h?Object(g.jsxs)("div",{className:"error",children:["Error: ",h]}):null,v?Object(g.jsx)(z,{graph:v}):null]})};s.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(S,{})}),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.fb0d48e7.chunk.js.map